<!DOCTYPE html>
<form method="post" action="brm/administrator/">
	<fieldset>
		<legend>添加新用户</legend>
		<p>
			<label class="required" for="name">用户名:</label><br/>
			<input title="用户名" type="text" id="name" class="full" name="name" required="required" />
			<small>e.g. ui.templates</small>
		</p>
		<p>
			<label class="required" for="groupId">组别:</label><br/>
			<input title="密码" type="text" id="groupId" class="full" name="groupId" required="required" />
		</p>
		<p>
			<label class="required" for="role">角色:</label><br/>
			<input title="密码" type="text" id="role" class="full" name="role" required="required" />
		</p>
		<p class="box">
			<input type="submit" class="btn btn-green big" value="提交"/>&nbsp;&nbsp;或&nbsp;&nbsp;<input type="button" class="btn big nyroModalClose" value="取消"/>
		</p>
	</fieldset>
</form>

<!--

// validate form on keyup and submit
var validator = $("#sampleform").validate({
	onkeyup: false,
	rules: {
		username: {
			required: true,
			minlength: 3,
			//remote: "/nebula-rest-sample/Admin/user/!userExist/"	// 简单写法，用GET方法，后跟元素名 + 值
			remote: {
				url: "/nebula-rest-sample/administry/user/!userExist/",
				type: "GET",
				data: {
					username: function() {
						return $("#username").val();
					}
				},
				dataType: "json",
				dataFilter: function(data, type) {
					if ("true" == data) {
						return "false";
					} else {
						return"true";
					}
				}
			}
		},
		password: {
			required: true,
			minlength: 5
		},
		password_confirm: {
			required: true,
			minlength: 5,
			equalTo: "#password"
		},
		firstname: "required",
		lastname: "required",
		sex: "required",
		email: {
			required: true,
			email: true
		}
	},
	messages: {
		username: {
			required: "用户名不能为空！",
			minlength: jQuery.format("用户名不能少于 {0} 位"),
			remote: "用户已存在！"
		},
		password: {
			required: "密码不能为空！",
			minlength: jQuery.format("密码不能少于 {0} 位")
		},
		password_confirm: {
			required: "确认密码不能为空！",
			minlength: jQuery.format("确认密码不能少于 {0} 位"),
			equalTo: "确认密码与密码不一致！"
		},
		firstname: "姓不能为空！",
		lastname: "名不能为空！",
		sex: "性别不能为空！",
		email: {
			required: "请输入一个有效的邮箱地址！",
			email: "输入一个有效的邮箱地址！"
		}
	},
	// the errorPlacement has to take the layout into account
	errorPlacement: function(error, element) {
		error.insertAfter(element.parent().find('label:first'));
	},
	// set new class to error-labels to indicate valid fields
	success: function(label) {
		// set &nbsp; as text for IE
		label.html("&nbsp;").addClass("ok");
	},
	// specifying a submitHandler prevents the default submit, good for the demo
	submitHandler: function(form) {
		$.ajax({
			type : "POST",
			url : "/nebula-rest-sample/administry/user/",
        	data : $.each($(form).serializeArray(), function(i, f) {
						if (f.name == "password" || f.name == "password_confirm")
			        		f.value = $.md5(f.value);
					}),
			dataType : "json",
			async : true,
			success : function(data) {
				$.nmTop().close();
				oTable.fnDraw();
			},
			error : function(XMLHttpRequest, textStatus, errorThrown) {
				alert("创建用户时发生错误！");
			}
		});
	}
});
//-->